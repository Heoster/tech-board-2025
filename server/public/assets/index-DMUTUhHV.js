const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TechnoBoardLanding-DSo4KNqC.js","assets/vendor-react-CY1O2pxN.js","assets/vendor-misc-IyfMy1hy.js","assets/ModernLoginForm-g4iEwpEE.js","assets/authService-CNyEGrwA.js","assets/vendor-utils-C-1G2k3o.js","assets/StudentRegistration-D0XSXAvW.js","assets/AdminLogin-DEGPLZll.js","assets/Dashboard-fL4t4GDu.js","assets/ImprovedQuizInterface-BFzFfVIL.js","assets/TestSubmitted-DTCcdI-j.js","assets/AdminPanel-DiUxe0U8.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,r,s)=>((t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s)(t,"symbol"!=typeof r?r+"":r,s);import{r,R as s,j as n,N as i,a,b as o,c as l,B as c}from"./vendor-react-CY1O2pxN.js";import{a as u}from"./vendor-utils-C-1G2k3o.js";import"./vendor-misc-IyfMy1hy.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const d={},h=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in d)return;d[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,r&&n.setAttribute("nonce",r),document.head.appendChild(n),t?new Promise((t,r)=>{n.addEventListener("load",t),n.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})};class m{static encrypt(e){if(!e)return"";const t="TB2025_KEY";let r="";for(let s=0;s<e.length;s++)r+=String.fromCharCode(e.charCodeAt(s)^t.charCodeAt(s%10));return btoa(r)}static decrypt(e){if(!e)return"";try{const t=atob(e),r="TB2025_KEY";let s="";for(let e=0;e<t.length;e++)s+=String.fromCharCode(t.charCodeAt(e)^r.charCodeAt(e%r.length));return s}catch{return""}}static setToken(e){if(e)try{const t=this.encrypt(e);localStorage.setItem(this.PREFIX+this.TOKEN_KEY,t);const r=Date.now()+864e5;localStorage.setItem(this.PREFIX+this.TOKEN_KEY+"_exp",r.toString())}catch{}else this.removeToken()}static getToken(){try{const e=localStorage.getItem(this.PREFIX+this.TOKEN_KEY),t=localStorage.getItem(this.PREFIX+this.TOKEN_KEY+"_exp");if(!e||!t)return null;if(Date.now()>parseInt(t))return this.removeToken(),null;const r=this.decrypt(e);return r&&r.includes(".")?r:(this.removeToken(),null)}catch{return this.removeToken(),null}}static removeToken(){localStorage.removeItem(this.PREFIX+this.TOKEN_KEY),localStorage.removeItem(this.PREFIX+this.TOKEN_KEY+"_exp")}static setUserData(e){if(e)try{const t=this.sanitizeUserData(e),r=this.encrypt(JSON.stringify(t));localStorage.setItem(this.PREFIX+this.USER_KEY,r)}catch{}else this.removeUserData()}static getUserData(){try{const e=localStorage.getItem(this.PREFIX+this.USER_KEY);if(!e)return null;const t=this.decrypt(e);return t?JSON.parse(t):null}catch{return this.removeUserData(),null}}static removeUserData(){localStorage.removeItem(this.PREFIX+this.USER_KEY)}static clearAll(){this.removeToken(),this.removeUserData()}static sanitizeUserData(e){if(!e||"object"!=typeof e||Array.isArray(e))return{};const t={...e};return delete t.password,delete t.password_hash,Object.keys(t).forEach(e=>{"string"==typeof t[e]&&(t[e]=this.sanitizeString(t[e]))}),t}static sanitizeString(e){return"string"!=typeof e?e:e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").trim()}}t(m,"PREFIX","techboard_"),t(m,"TOKEN_KEY","auth_token"),t(m,"USER_KEY","user_data");class p{static sanitizeInput(e){return"string"!=typeof e?"":e.trim().replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").replace(/data:text\/html/gi,"").substring(0,1e3)}static validateName(e){const t=this.sanitizeInput(e);return this.patterns.name.test(t)}static validateRollNumber(e){const t=e.toString();return this.patterns.rollNumber.test(t)}static validateGrade(e){const t=e.toString();return this.patterns.grade.test(t)}static validateSection(e){return this.patterns.section.test(e)}static validatePassword(e){return this.patterns.password.test(e)}static isValidInput(e){if(null==e)return!1;if("string"==typeof e&&""===e.trim())return!1;const t=e.toString();return![/<script/i,/<iframe/i,/javascript:/i,/on\w+\s*=/i,/data:text\/html/i,/vbscript:/i,/expression\s*\(/i].some(e=>e.test(t))}}t(p,"patterns",{email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,name:/^[a-zA-Z\s'-]{2,100}$/,rollNumber:/^([1-9]|[1-9][0-9]|100)$/,password:/^.{6,}$/,grade:/^(6|7|8|9|11)$/,section:/^[AB]$/});class f{static sanitizeApiResponse(e){if(!e||"object"!=typeof e)return e;const t=JSON.parse(JSON.stringify(e));return this.sanitizeObject(t),t}static sanitizeObject(e){if(Array.isArray(e))e.forEach(e=>this.sanitizeObject(e));else if(e&&"object"==typeof e){const t=e;Object.keys(t).forEach(e=>{"string"==typeof t[e]?t[e]=p.sanitizeInput(t[e]):"object"==typeof t[e]&&this.sanitizeObject(t[e])})}}static shouldRetry(e,t){if(!t||"string"!=typeof t)return!1;const r=this.sanitizeEndpoint(t);if(!r)return!1;const s=this.retryAttempts.get(r)||0;if(s>=this.MAX_RETRY_ATTEMPTS)return this.retryAttempts.delete(r),!1;return!(e.response&&!(e.response.status>=500)&&"NETWORK_ERROR"!==e.code)&&(this.retryAttempts.set(r,s+1),!0)}static getRetryDelay(e){if(!e||"string"!=typeof e)return this.RETRY_DELAY;const t=this.sanitizeEndpoint(e);if(!t)return this.RETRY_DELAY;const r=this.retryAttempts.get(t)||0;return this.RETRY_DELAY*Math.pow(2,r)}static clearRetryAttempts(e){if(!e||"string"!=typeof e)return;const t=this.sanitizeEndpoint(e);t&&this.retryAttempts.delete(t)}static sanitizeEndpoint(e){const t=p.sanitizeInput(e);return/^\/[a-zA-Z0-9/_-]+(\?[a-zA-Z0-9=&_-]*)?$/.test(t)?t.length>200?null:t:null}static sanitizeErrorMessage(e){var t,r,s,n,i,a,o;if(!e)return"An unknown error occurred";if((null==(t=e.response)?void 0:t.status)>=500)return"Server is temporarily unavailable. Please try again later.";if(429===(null==(r=e.response)?void 0:r.status))return"Too many requests. Please wait before trying again.";if("NETWORK_ERROR"===e.code)return"Network error. Please check your internet connection.";const l=(null==(i=null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.error)?void 0:i.message)||(null==(o=null==(a=e.response)?void 0:a.data)?void 0:o.message)||e.message||"An error occurred";return p.sanitizeInput(l)}}t(f,"MAX_RETRY_ATTEMPTS",3),t(f,"RETRY_DELAY",1e3),t(f,"retryAttempts",new Map);class g{static isProductionEnvironment(){return!0}static isSecureContext(){return window.isSecureContext||"https:"===location.protocol}static checkCSP(){return!!document.querySelector('meta[http-equiv="Content-Security-Policy"]')}static validateEnvironment(){const e=[];if(!this.isSecureContext()&&this.isProductionEnvironment()&&e.push("Application should be served over HTTPS in production"),!this.checkCSP()&&this.isProductionEnvironment()&&e.push("Content Security Policy should be configured"),this.isProductionEnvironment())try{console.log&&console.log.toString&&-1===(void 0).indexOf("[native code]")&&e.push("Development console tools detected in production")}catch{}return{valid:0===e.length,warnings:e}}static removeDebugCode(){if(this.isProductionEnvironment()){const e=()=>{};console.log=e,console.info=e,console.debug=e,console.warn=e}}}if(g.isProductionEnvironment()){g.validateEnvironment().valid}const E={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"/api",VITE_APP_DESCRIPTION:"Computer Skills Assessment Platform",VITE_APP_TITLE:"TECH BOARD 2025",VITE_APP_VERSION:"1.0.0",VITE_ENABLE_ANALYTICS:"false",VITE_ENABLE_DEVTOOLS:"false",VITE_ENABLE_PWA:"true",VITE_RAILWAY_URL:"https://tech-board.up.railway.app"},y=(e,t="")=>{try{return E[e]||t}catch{return t}};const v=new class{constructor(){t(this,"client"),t(this,"baseURL"),t(this,"requestQueue",new Map);const e="true"===y("DEV")||"development"===y("MODE")||"localhost"===window.location.hostname;this.baseURL=y("VITE_API_URL")||(e?"http://localhost:8000/api":"/api"),this.client=u.create({baseURL:this.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"},withCredentials:!0}),this.setupInterceptors()}setupInterceptors(){this.client.interceptors.request.use(e=>{var t,r,s,n;return e.headers["X-Request-ID"]=crypto.randomUUID(),null==(t=e.url)||t.includes("auth/"),e.data&&!(null==(r=e.url)?void 0:r.includes("auth/"))&&(e.data=this.sanitizeRequestData(e.data)),null==(s=e.url)||s.includes("auth/"),["post","put","delete","patch"].includes((null==(n=e.method)?void 0:n.toLowerCase())||"")&&(e.headers["X-Requested-With"]="XMLHttpRequest"),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>(e.config.url&&f.clearRetryAttempts(e.config.url),e.data&&(e.data=f.sanitizeApiResponse(e.data)),e),async e=>this.handleResponseError(e))}async handleResponseError(e){var t,r,s;const n=(null==(t=e.config)?void 0:t.url)||"";if(e.code,429===(null==(r=e.response)?void 0:r.status)&&e.response.headers["retry-after"],f.shouldRetry(e,n)){const t=f.getRetryDelay(n);await new Promise(e=>setTimeout(e,t));try{return await this.client.request(e.config)}catch(i){}}return(null==(s=e.response)?void 0:s.data)&&(e.response.data=f.sanitizeApiResponse(e.response.data)),Promise.reject(e)}sanitizeRequestData(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>this.sanitizeRequestData(e));const t={...e};return Object.keys(t).forEach(e=>{if("string"==typeof t[e]){const r=t[e];t[e]=p.sanitizeInput(r),(r.includes("<script")||r.includes("javascript:")||r.includes("<iframe"))&&(t[e]="")}else"object"==typeof t[e]&&null!==t[e]&&(t[e]=this.sanitizeRequestData(t[e]))}),t}async makeUniqueRequest(e,t){if(this.requestQueue.has(e))return this.requestQueue.get(e);const r=t().finally(()=>{this.requestQueue.delete(e)});return this.requestQueue.set(e,r),r}async get(e,t){try{const r=`GET:${e}:${JSON.stringify((null==t?void 0:t.params)||{})}`;return await this.makeUniqueRequest(r,()=>this.client.get(e,t))}catch(r){throw new Error(f.sanitizeErrorMessage(r))}}async post(e,t,r){try{return e.includes("auth/login")||e.includes("auth/register"),await this.client.post(e,t,r)}catch(s){throw new Error(f.sanitizeErrorMessage(s))}}async put(e,t,r){try{return await this.client.put(e,t,r)}catch(s){throw new Error(f.sanitizeErrorMessage(s))}}async delete(e,t){try{return await this.client.delete(e,t)}catch(r){throw new Error(f.sanitizeErrorMessage(r))}}validateAuthData(e){if(!e||"object"!=typeof e)throw new Error("Invalid authentication data");const t=e;if(void 0!==t.rollNumber&&("string"!=typeof t.rollNumber||!p.validateRollNumber(t.rollNumber)))throw new Error("Invalid roll number format");if(void 0!==t.grade&&("number"!=typeof t.grade||!p.validateGrade(t.grade)))throw new Error("Invalid grade");if(void 0!==t.section&&("string"!=typeof t.section||!p.validateSection(t.section)))throw new Error("Invalid section");if(void 0!==t.password&&("string"!=typeof t.password||!p.validatePassword(t.password)))throw new Error("Password does not meet requirements");if(void 0!==t.name&&("string"!=typeof t.name||!p.validateName(t.name)))throw new Error("Invalid name format")}async healthCheck(){const e=Date.now();try{return await this.get("/health"),{healthy:!0,responseTime:Date.now()-e}}catch{return{healthy:!1,responseTime:Date.now()-e}}}setAuthToken(e){e?(this.client.defaults.headers.common.Authorization=`Bearer ${e}`,"true"===y("DEV")||y("MODE")):(delete this.client.defaults.headers.common.Authorization,"true"===y("DEV")||y("MODE"))}getAuthStatus(){const e=this.client.defaults.headers.common.Authorization;return{hasToken:!!e,token:e?String(e).replace("Bearer ",""):void 0}}cancelAllRequests(){this.requestQueue.clear()}},b=r.createContext(void 0),_=({children:e})=>{const[t,s]=r.useState(null),[i,a]=r.useState(null),[o,l]=r.useState(!0);r.useEffect(()=>{c()},[]);const c=async()=>{try{const e=m.getToken(),t=m.getUserData();e&&t?u(t)?(a(e),s(t),d(e)):f():d(null)}catch(e){f()}finally{l(!1)}},u=e=>{if(!e||"object"!=typeof e)return!1;const t=e;if("number"!=typeof t.id||"string"!=typeof t.role)return!1;if(!["student","admin"].includes(t.role))return!1;if("student"===t.role){if(t.rollNumber&&!p.validateRollNumber(t.rollNumber))return!1;if(t.grade&&!p.validateGrade(t.grade))return!1;if(t.section&&!p.validateSection(t.section))return!1}return!(t.name&&!p.isValidInput(t.name))},d=e=>{v.setAuthToken(e)},h=e=>{const t={id:e.id,role:e.role};return e.name&&(t.name=p.sanitizeInput(e.name)),e.username&&(t.username=p.sanitizeInput(e.username)),e.email&&(t.email=p.sanitizeInput(e.email)),e.rollNumber&&(t.rollNumber=e.rollNumber),e.grade&&(t.grade=e.grade),e.section&&(t.section=e.section),t},f=()=>{try{a(null),s(null),m.clearAll(),d(null)}catch(e){}},g={user:t,token:i,login:(e,t)=>{try{if(!e||"string"!=typeof e||!e.includes("."))throw new Error("Invalid token format");if(!u(t))throw new Error("Invalid user data");const r=h(t);d(e),a(e),s(r),m.setToken(e),m.setUserData(r)}catch(r){throw f(),r}},logout:f,loading:o,isAuthenticated:!(!t||!i)};return n.jsx(b.Provider,{value:g,children:e})},j=()=>{const e=s.useContext(b);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},w=({children:e,role:t})=>{const{user:r,loading:s,token:a}=j();if(s)return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"Verifying authentication..."})]})});if(!r||!a)return n.jsx(i,{to:"/login",replace:!0});if(t&&r.role!==t){const e="admin"===r.role?"/admin/dashboard":"/dashboard";return n.jsx(i,{to:e,replace:!0})}return n.jsx(n.Fragment,{children:e})},R=()=>n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),n.jsx("div",{className:"absolute inset-0 w-16 h-16 border-4 border-transparent border-r-indigo-400 rounded-full animate-spin mx-auto",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Loading..."}),n.jsx("p",{className:"text-sm text-gray-500",children:"Preparing your experience"})]}),n.jsxs("div",{className:"flex justify-center space-x-1 mt-4",children:[n.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"}),n.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),n.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]})]})}),A=r.lazy(()=>h(()=>import("./TechnoBoardLanding-DSo4KNqC.js"),__vite__mapDeps([0,1,2]))),x=r.lazy(()=>h(()=>import("./ModernLoginForm-g4iEwpEE.js"),__vite__mapDeps([3,1,2,4,5]))),I=r.lazy(()=>h(()=>import("./StudentRegistration-D0XSXAvW.js"),__vite__mapDeps([6,1,2,4,5]))),T=r.lazy(()=>h(()=>import("./AdminLogin-DEGPLZll.js"),__vite__mapDeps([7,1,2,5]))),S=r.lazy(()=>h(()=>import("./Dashboard-fL4t4GDu.js"),__vite__mapDeps([8,1,2,5]))),P=r.lazy(()=>h(()=>import("./ImprovedQuizInterface-BFzFfVIL.js"),__vite__mapDeps([9,1,2,5]))),N=r.lazy(()=>h(()=>import("./TestSubmitted-DTCcdI-j.js"),__vite__mapDeps([10,1,2]))),D=r.lazy(()=>h(()=>import("./AdminPanel-DiUxe0U8.js"),__vite__mapDeps([11,1,2,5])));function z(){return n.jsx(_,{children:n.jsx("div",{className:"min-h-screen",children:n.jsx(r.Suspense,{fallback:n.jsx(R,{}),children:n.jsxs(a,{children:[n.jsx(o,{path:"/",element:n.jsx(A,{})}),n.jsx(o,{path:"/login",element:n.jsx(x,{})}),n.jsx(o,{path:"/register",element:n.jsx(I,{})}),n.jsx(o,{path:"/admin/login",element:n.jsx(T,{})}),n.jsx(o,{path:"/dashboard",element:n.jsx(w,{role:"student",children:n.jsx(S,{})})}),n.jsx(o,{path:"/test",element:n.jsx(w,{role:"student",children:n.jsx(P,{})})}),n.jsx(o,{path:"/test-submitted",element:n.jsx(w,{role:"student",children:n.jsx(N,{})})}),n.jsx(o,{path:"/admin/dashboard",element:n.jsx(w,{role:"admin",children:n.jsx(D,{})})}),n.jsx(o,{path:"*",element:n.jsx(A,{})})]})})})})}const O=document.getElementById("root");if(!O)throw new Error("Root element not found");l(O).render(n.jsx(r.StrictMode,{children:n.jsx(c,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:n.jsx(z,{})})}));export{v as a,j as u};
