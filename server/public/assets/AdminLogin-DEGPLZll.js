import{r as e,u as a,j as t,L as r}from"./vendor-react-CY1O2pxN.js";import{u as s,a as n}from"./index-DMUTUhHV.js";import"./vendor-misc-IyfMy1hy.js";import"./vendor-utils-C-1G2k3o.js";const o=()=>{const[o,l]=e.useState({username:"",password:""}),[i,d]=e.useState(""),[c,m]=e.useState(!1),[u,g]=e.useState(!1),[x,p]=e.useState(0),{login:h}=s(),v=a();e.useEffect(()=>{(()=>{const e=localStorage.getItem("adminLockoutEnd");if(e){const a=parseInt(e)-Date.now();if(a>0){g(!0),p(Math.ceil(a/1e3));const t=setInterval(()=>{const a=parseInt(e)-Date.now();a<=0?(g(!1),p(0),localStorage.removeItem("adminLockoutEnd"),clearInterval(t)):p(Math.ceil(a/1e3))},1e3);return()=>clearInterval(t)}localStorage.removeItem("adminLockoutEnd")}})()},[]);const f=e=>{l({...o,[e.target.name]:e.target.value})};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 py-12 px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"max-w-md w-full space-y-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-red-500 to-orange-500 rounded-full flex items-center justify-center mb-4",children:t.jsx("svg",{className:"h-8 w-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),t.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"üîê Admin Access"}),t.jsx("p",{className:"mt-2 text-sm text-gray-600",children:t.jsx(r,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"‚Üê Back to Student Login"})}),u&&t.jsxs("div",{className:"mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("svg",{className:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),t.jsx("span",{className:"font-medium",children:"Access Temporarily Blocked"})]}),t.jsxs("p",{className:"mt-1 text-sm",children:["Too many failed login attempts detected.",t.jsx("br",{}),t.jsxs("strong",{children:[Math.ceil(x/60),":",String(x%60).padStart(2,"0")]})," time remaining until access is restored."]})]})]}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:async e=>{var a,t,r,s,l,i,c;if(e.preventDefault(),u)d(`Access blocked. Try again in ${Math.ceil(x/60)} minutes.`);else{d(""),m(!0);try{const e={userAgent:navigator.userAgent,language:navigator.language,timestamp:Date.now()},a=(await n.post("/auth/admin/login",{...o,browserInfo:e,securityLevel:"normal"})).data;if(!a.success)throw new Error(a.error||"Login failed");const{token:t,user:r}=a.data;h(t,{...r,id:"string"==typeof r.id?parseInt(r.id):r.id,role:"admin"}),v("/admin/dashboard")}catch(f){const e=f;if(423===(null==(a=e.response)?void 0:a.status)){const a=null==(r=null==(t=e.response.data)?void 0:t.error)?void 0:r.details;if(null==a?void 0:a.remainingSeconds){const e=Date.now()+1e3*a.remainingSeconds;localStorage.setItem("adminLockoutEnd",e.toString()),g(!0),p(a.remainingSeconds),d(`Account locked. Try again in ${Math.ceil(a.remainingSeconds/60)} minutes.`)}}else{const a=(null==(l=null==(s=e.response)?void 0:s.data)?void 0:l.error)||(null==(c=null==(i=e.response)?void 0:i.data)?void 0:c.message)||e.message||"Login failed. Please try again.";d(a)}}finally{m(!1)}}},children:[i&&t.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:i}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Username"}),t.jsx("input",{name:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 sm:text-sm",placeholder:"Enter admin username",value:o.username,onChange:f,disabled:c||u})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Password"}),t.jsx("input",{name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 sm:text-sm",placeholder:"Enter admin password",value:o.password,onChange:f,disabled:c||u})]})]}),t.jsx("div",{children:t.jsxs("button",{type:"submit",disabled:c||u,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:[t.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:t.jsx("svg",{className:"h-5 w-5 text-red-300 group-hover:text-red-200",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})}),c?"Authenticating...":u?`Blocked (${Math.ceil(x/60)}m)`:"Admin Login"]})}),t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-xs text-gray-500",children:"üõ°Ô∏è This is a secured admin area. All login attempts are monitored and logged."})})]})]})})};export{o as default};
